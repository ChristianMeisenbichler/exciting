%                **** IMPORTANT NOTICE *****
% This LaTeX file has been automatically produced by ProTeX v. 1.1
% Any changes made to this file will likely be lost next time
% this file is regenerated from its source. Send questions 
% to Arlindo da Silva, dasilva@gsfc.nasa.gov
 
%------------------------ PREAMBLE --------------------------
\documentclass[11pt]{article}
\usepackage{amsmath}
\usepackage{epsfig}
\usepackage{hangcaption}
\usepackage{tabularx}
\textheight     9in
\topmargin      0pt
\headsep        1cm
\headheight     0pt
\textwidth      6in
\oddsidemargin  0in
\evensidemargin 0in
\marginparpush  0pt
\pagestyle{myheadings}
\markboth{}{}
%-------------------------------------------------------------
\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}
\setlength{\baselineskip}{11pt}
 
%--------------------- SHORT-HAND MACROS ----------------------
\def\bv{\begin{verbatim}}
\def\ev{\end{verbatim}}
\def\be{\begin{equation}}
\def\ee{\end{equation}}
\def\bea{\begin{eqnarray}}
\def\eea{\end{eqnarray}}
\def\bi{\begin{itemize}}
\def\ei{\end{itemize}}
\def\bn{\begin{enumerate}}
\def\en{\end{enumerate}}
\def\bd{\begin{description}}
\def\ed{\end{description}}
\def\({\left (}
\def\){\right )}
\def\[{\left [}
\def\]{\right ]}
\def\<{\left  \langle}
\def\>{\right \rangle}
\def\cI{{\cal I}}
\def\diag{\mathop{\rm diag}}
\def\tr{\mathop{\rm tr}}
%-------------------------------------------------------------

\markboth{Left}{Source File: xsmain.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
\title{The XS/EXCITING Code (eXited States) Manual \\ Version 0.9}
\author{{\sc S. Sagmeister and C. Ambrosch-Draxl}\\ {\em }}
\date{}
\begin{document}
\maketitle
\tableofcontents
\newpage
 
%..............................................
\section{Introduction}

     Welcome to the {\sf XS/EXCITING} code developers' manual
     This is supposed to collect the routines and modules belonging
     only to the excited states (TDDFT and BSE) part into one document.
     \\\\
     S. Sagmeister\\
     Leoben, 2008
   
%/////////////////////////////////////////////////////////////
\newpage

\markboth{Left}{Source File: argparse.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: bandgap.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
\section{Routine/Function Prologues} \label{app:ProLogues}
\subsection{bandgapgrid (Source File: bandgap.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim}   subroutine bandgap(n,e,ef,egf,ego,ikgf,ikgo,istho)\end{verbatim}{\em USES:}
\begin{verbatim}     use modmain\end{verbatim}
{\sf DESCRIPTION:\\ }


     Determines the fundamental and optical band gap if present.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created July 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: bse.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: chi0upd.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: connecta.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{connecta (Source File: connecta.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine connecta(cvec,nv,np,vvl,vpl,dv,dp)\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     cvec : matrix of (reciprocal) lattice vectors stored column-wise
           (in,real(3,3))
     nv   : number of vertices (in,integer)
     np   : number of connecting points (in,integer)
     vvl  : vertex vectors in lattice coordinates (in,real(3,nv))
     vpl  : connecting point vectors in lattice coordinates (out,real(3,np))
     dv   : cummulative distance to each vertex (out,real(nv))
     dp   : cummulative distance to each connecting point (out,real(np))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Generates a set of points which interpolate between a given set of vertices.
     Vertex points are supplied in lattice coordinates in the array {\tt vvl} and
     converted to Cartesian coordinates with the matrix {\tt cvec}. Interpolating
     points are stored in the array {\tt vpl}. The cummulative distances to the
     vertices and points along the path are stored in arrays {\tt dv} and
     {\tt dp}, respectively. Based upon the routine {\tt connect}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created June 2003 (JKD)
     Modifications 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: ctdfrac.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: df.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dfgather.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dfq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dfqoscbo.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dfqoschd.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dfqoscwg.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dftim.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: dyson.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematbdcmbs.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematbdlims.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematgather.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematgntsum.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematqalloc.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematqdealloc.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematqk1.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematqk.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematqkgir.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematqkgmt.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ematrad.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: emattest.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: emattim.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: epsconv.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: exccoulint.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: filedel.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: findexciton.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: findgntn0.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: findgroupq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: findkmapkq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: findocclims.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: findsymi.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: ftfun.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: fxc\_alda\_check.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: fxc\_bse\_ma03.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: fxc\_lrcd.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: fxc\_lrc.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: fxc\_pwca.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{xcd\_pwca (Source File: fxc\_pwca.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine xcd_pwca(n,rho,dvx,dvc)\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     n     : number of density points (in,integer)
     rho   : charge density (in,real(n))
     dvx   : exchange potential derivative (out,real(n))
     dvc   : correlation potential derivative (out,real(n))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Spin-unpolarised exchange-correlation potential derivative of the 
     Perdew-Wang
     parameterisation of the Ceperley-Alder electron gas,
     Phys. Rev. B 45, 13244
     (1992) and Phys. Rev. Lett. 45, 566 (1980). Based upon the routine
     {\tt xc\_pwca}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created February 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: genapwcmt.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genfilextread.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genfilname.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gengqvec.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{gengqvec (Source File: gengqvec.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine gengqvec(iq,vpl,vpc,ngp,igpig,vgpl,vgpc,gpc,tpgpc)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     vpl   : p-point vector in lattice coordinates (in,real(3))
     vpc   : p-point vector in Cartesian coordinates (in,real(3))
     ngp   : number of G+p-vectors returned (out,integer)
     igpig : index from G+p-vectors to G-vectors (out,integer(ngkmax))
     vgpl  : G+p-vectors in lattice coordinates (out,real(3,ngkmax))
     vgpc  : G+p-vectors in Cartesian coordinates (out,real(3,ngkmax))
     gpc   : length of G+p-vectors (out,real(ngkmax))
     tpgpc : (theta, phi) coordinates of G+p-vectors (out,real(2,ngkmax))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Generates a set of ${\bf G+p}$-vectors for the input ${\bf p}$-point with
     length less than {\tt gkmax}. These are used as the plane waves in the APW
     functions. Also computes the spherical coordinates of each vector.
     Based on gengpvec.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: genloss.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genparidxran.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genpmat2.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{genpmat2 (Source File: genpmat2.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine genpmat2(ngp,igpig,vgpc,ripaa,ripalo,riploa,riplolo,apwcmt,locmt, &
      evecfv,evecsv,pmat)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     ngp    : number of G+p-vectors (in,integer)
     igpig  : index from G+p-vectors to G-vectors (in,integer(ngkmax))
     vgpc   : G+p-vectors in Cartesian coordinates (in,real(3,ngkmax))
     ripaa  : gradient of radial functions time spherical harmonics (APW-APW)
              (in,complex(apwordmax,lmmaxapw,apwordmax,lmmaxapw,natmtot,3))
     ripalo : gradient of radial functions time spherical harmonics (APW-lo)
              (in,complex(apwordmax,lmmaxapw,nlomax,-lolmax:lolmax,natmtot,3))
     riploa : gradient of radial functions time spherical harmonics (lo-APW)
              (in,complex(nlomax,-lolmax:lolmax,apwordmax,lmmaxapw,natmtot,3))
     riplolo: gradient of radial functions time spherical harmonics (lo-lo)
              (in,complex(nlomax,-lolmax:lolmax,nlomax,-lolmax:lolmax,natmtot,3))
     apwcmt : APW expansion coefficients coefficients
              (in,complex(nstfv,apwordmax,lmmaxapw,natmtot))
     locmt  : local orbitals expansion coefficients coefficients
              (in,complex(nstfv,nlomax,-lolmax:lolmax,natmtot))
     evecfv : first-variational eigenvector (in,complex(nmatmax,nstfv))
     evecsv : second-variational eigenvectors (in,complex(nstsv,nstsv))
     pmat   : momentum matrix elements (out,complex(3,nstsv,nstsv))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Calculates the momentum matrix elements
     $$ p_{ij}=\langle\Psi_{i,{\bf k}}|-i\nabla|\Psi_{j,{\bf k}}\rangle. $$
     The gradient is applied explicitly only to the radial functions and 
     corresponding spherical harmonics for the muffin-tin part. In the 
     interstitial region the gradient is evaluated analytically.
     Parts taken from the routine {\tt genpmat}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created April 2008 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: genpwmat.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{genpwmat (Source File: genpwmat.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine genpwmat(vpl,ngpmax,ngp,vgpc,gpc,igpig,ylmgp,sfacgp,vklk,ngkk, &
      igkigk,apwalmk,evecfvk,evecsvk,vklkp,ngkkp,igkigkp,apwalmkp,evecfvkp, &
      evecsvkp,pwmat)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim} \end{verbatim}
{\sf DESCRIPTION:\\ }

    Calculates the matrix elements of the plane wave
     $$ p_{ij}=\langle\Psi_{i,{\bf k}}|e^{-i({\bf G}+{\bf q}){\bf r}}|
        \Psi_{j,{\bf k}}\rangle. $$
    Straightforward implementation for checking.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created November 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: genqvkloff.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gensigma.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genstar.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{genstar (Source File: genstar.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine genstar(tsmgrq,ngridp,nppt,npptnr,vpl,vplnr,ivpnr,ipmap,ipmapnr, &
      nsymcrysst,scmapst,ipstmapipnr,stmap,stmapsymc)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs\end{verbatim}
{\sf DESCRIPTION:\\ }


     Generates the stars for the $k$-point set as reference to crystal
     symmetries. For a non-zero q-point the little group of q is taken
     instead of the full symmetry group.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created December 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: genstark.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{genstark (Source File: genstark.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine genstark\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs\end{verbatim}
{\sf DESCRIPTION:\\ }


     Generates the stars for the ${\bf k}$-point set as reference to crystal
     symmetries. For a non-zero ${\bf q}$-point the little group of ${\bf q}$
     is taken instead of the full symmetry group.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created December 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: gensumrls.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gensymdf.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gentetlink.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{gentetlink (Source File: gentetlink.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine gentetlink(vpl)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modtetra\end{verbatim}
{\sf DESCRIPTION:\\ }


     Generates an array connecting the tetrahedra of the $\mathbf{k}$-point with
     the ones of the  $\mathbf{k}+\mathbf{q}$-point. Interface routine
     referencing the {\tt libbzint} library of Ricardo Gomez-Abal.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created January 2008 (SAG)\end{verbatim}

\markboth{Left}{Source File: gentim.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genwgrid.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: genwiq2xs.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{genwiq2xs (Source File: genwiq2xs.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine genwiq2xs(flag,iq,igq1,igq2,clwt)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs
   use m_genfilname
   use m_getunit\end{verbatim}
{\sf DESCRIPTION:\\ }


     Effective integrals of Coulomb interaction.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created February 2008 (SAG)\end{verbatim}

\markboth{Left}{Source File: genylmgq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{genylmgq (Source File: genylmgq.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine genylmgq(iq,lmax)\end{verbatim}{\em USES:}
\begin{verbatim} use modmain
 use modxs\end{verbatim}
{\sf DESCRIPTION:\\ }


     Generates a set of spherical harmonics, $Y_{lm}(\widehat{{\bf G}+{\bf q}})$,
     with angular
     momenta up to {\tt lmax} for the set of ${\bf G+q}$-vectors. Based upon
     the routine genylmg.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: getapwdlm.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getdevaldoccsv.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getemat.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getevalsv0.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getevecfv0.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getngqmax.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{getngqmax (Source File: getngqmax.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine getngqmax\end{verbatim}{\em USES:}
\begin{verbatim} use modmain
 use modxs\end{verbatim}
{\sf DESCRIPTION:\\ }


     Determines the largest number of ${\bf G+q}$-vectors with length less than
     {\tt gqmax} over all the ${\bf q}$-points and stores it in the global
     variable {\tt ngqmax}. This variable is used for allocating arrays.
     Based upon the routine getngkmax.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: getoccsv0.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getpemat.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getpmat.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getridx.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gettetcw.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getunit.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: getx0.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gndstateq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: gradzfmtr.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{gradzfmtr (Source File: gradzfmtr.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine gradzfmtr(lmax,nr,r,l1,m1,ld1,ld2,fmt,gfmt)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain, only: idxlm\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     lmax  : maximum angular momentum (in,integer)
     nr    : number of radial mesh points (in,integer)
     r     : radial mesh (in,real(nr))
     ld1   : leading dimension 1 (in,integer)
     ld2   : leading dimension 2 (in,integer)
     fmt  : real muffin-tin function (in,real(nr))
     gfmt : gradient of zfmt (out,real(ld1,ld2,3))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Calculates the gradient of a muffin-tin function with real spherical 
     harmonics expansion coefficients, $f(r)$, corresponding to a specific
     $lm$-combination. The gradient is given in a spherical harmonics
     representation.
     The $y$-component is divided by $i$ to be expressed as a real number.
     See routine {\tt gradzfmt}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created April 2008 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: i2str.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: idf.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: idfgather.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: idfq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: init1xs.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: init2xs.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: initbse.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: initoccbse.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: initscr.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: invert.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: kernxc\_bse.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: kernxc.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{fxc\_alda (Source File: kernxc.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine kernxc\end{verbatim}
{\sf DESCRIPTION:\\ }


     Computes the ALDA exchange-correlation kernel. In the
     muffin-tin, the density is transformed from spherical harmonic coefficients
     $\rho_{lm}$ to spherical coordinates $(\theta,\phi)$ with a backward
     spherical harmonic transformation (SHT). Once calculated, the
     exchange-correlation potential and energy density are transformed with a
     forward SHT. This routine is based upon the routine {\tt potxc}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created March 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: kramkron.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: l2int.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: linoptkpq.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: linoptold.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: mapto1bz.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: modfxcifc.F90,  Date: Wed May 14 11:56:00 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{fxcifc (Source File: modfxcifc.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim}   subroutine fxcifc(fxctype,w,iw,iq,ng,alrc,alrcd,blrcd,lrccoef,fxcg)
     use m_fxc_lrc
     use m_fxc_lrcd
      use m_fxc_lrcmodel
     use m_fxc_alda
     use m_fxc_bse_ma03\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     fxctype : type of exchange-correlation functional (in,integer)\end{verbatim}
{\sf DESCRIPTION:\\ }


     Interface to the exchange-correlation kernel routines. This makes it 
     relatively
     simple to add new functionals which do not necessarily depend only on
     all input parameters. Based upon the routine {\tt modxcifc}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2007 (Sagmeister)\end{verbatim}
 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{getfxcdata (Source File: modfxcifc.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim}   subroutine getfxcdata(fxctype,fxcdescr,fxcspin)\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     fxctype  : type of exchange-correlation functional (in,integer)
     fxcdescr : description of functional (out,character(256))
     fxcspin  : spin treatment (out,integer)
     fxcgrad  : gradient treatment (out,integer)\end{verbatim}
{\sf DESCRIPTION:\\ }


     Returns data on the exchange-correlation functional labelled by
     {\tt fxctype}. The character array {\tt fxctype} contains a short
     description
     of the functional including journal references. The variable 
     {\tt fxcspin} is
     set to 1 or 0 for spin-polarised or -unpolarised functionals,
     respectively.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: modifcs.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: modxs.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: octmap.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: pade.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: pmatgather.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: pmatrad.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: pmattd2orig.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: putemat.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: putpmat.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: puttetcw.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: putx0.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: r2str.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: scrcoulint2.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: scrcoulint3.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: scrcoulint.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: screen.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: scrgeneigvec.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: scrtetcalccw.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: showunits.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: sleepifc.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: stringtim.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: summations.F90,  Date: Wed May 14 11:56:00 CEST 2008
}


\markboth{Left}{Source File: symg2f.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{symg2f (Source File: symg2f.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine symg2f(vpl,ngp,igpig,fg)\end{verbatim}{\em USES:}
\begin{verbatim} use modmain
 use modxs
 \end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     vpl     :vpl
     ngp     :ngp
     igpig   :igpig
     fg      :fg\end{verbatim}
{\sf DESCRIPTION:\\ }


     Symmetrises a real scalar function given in $G$-space
     $$ f_{\bf q}({\bf G},{\bf G'}) = \frac{1}{\Omega}\int {\rm d}^3r 
     e^{-i{\bf (G+q)r}} f({\bf r},{\bf r'}) e^{i{\bf (G'}+{\bf q}){\bf r'}} $$
     of which its real-space representation is invariant under application of
     a symmetry  operation to both spatial variables, i.e.:
     $$ f({\bf r},{\bf r'}) = f(\{\alpha|\tau\}{\bf r},\{\alpha|\tau\}{\bf r'}).
     $$
     The symmetry operations are restricted to the subset that leaves the
     ${\bf q}$-vector unaltered
     $$ {\bf q}=\alpha^{-1}{\bf q} + {\bf G}_{\alpha},  $$
     building up the small (little) group of {\bf q}.
     For a function obeying the latter symmetry property one can derive a
     symmetry relation for the Fourier-coefficients as well:
     $$ f_{\bf q}({\bf G},{\bf G'}) =  
     e^{i({\bf G'}-{\bf G})\tau_{\alpha^{-1}}} 
     f_{\bf q}(\alpha[{\bf G}+{\bf G}_{\alpha}],
     \alpha[{\bf G'}+{\bf G}_{\alpha}]) =: f^{(\alpha)}_{\bf q}({\bf G},
     {\bf G'}).$$
     Since this property may not exactly be fulfilled numerically, an average
     of the rotated expressions $f^{(\alpha)}$ is taken:
     $$  \bar{f}_{\bf q}({\bf G},{\bf G'})= \frac{1}{N_{\bf q}}
     \sum_{\alpha}^{\mathcal{G}({\bf q})}
     f^{(\alpha)}_{\bf q}({\bf G},{\bf G'}) $$
     where $\mathcal{G}({\bf q})$ denotes the small (little) group of ${\bf q}$
     and $N_{\bf q}$ its number of elements.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created March 2008 (SAG)\end{verbatim}

\markboth{Left}{Source File: symsci0.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdchkstop.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdgauntgen.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdlinopt.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdsave0.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdwriteh.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdzoutpr2.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tdzoutpr.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: terminate.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: testmain.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: testxs.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tetcalccw.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tetcalccwq.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tetgather.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: tqgamma.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: updateq.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: wavefmt\_apw.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{wavefmt\_apw (Source File: wavefmt\_apw.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine wavefmt_apw(lrstp,lmax,is,ia,ngp,apwalm,evecfv,ld,wfmt)\end{verbatim}{\em USES:}
\begin{verbatim} use modmain\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     lrstp  : radial step length (in,integer)
     lmax   : maximum angular momentum required (in,integer)
     is     : species number (in,integer)
     ia     : atom number (in,integer)
     ngp    : number of G+p-vectors (in,integer)
     apwalm : APW matching coefficients
              (in,complex(ngkmax,apwordmax,lmmaxapw,natmtot))
     evecfv : first-variational eigenvector (in,complex(nmatmax))
     ld     : leading dimension (in,integer)
     wfmt   : muffin-tin wavefunction (out,complex(ld,*))\end{verbatim}
{\sf DESCRIPTION:\\ }


  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created April 2003 (JKD)
     Fixed description, October 2004 (C. Brouder)
     Removed argument ist, November 2006 (JKD)\end{verbatim}

\markboth{Left}{Source File: wavefmt\_lo.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{wavefmt\_lo (Source File: wavefmt\_lo.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine wavefmt_lo(lrstp,lmax,is,ia,ngp,apwalm,evecfv,ld,wfmt)\end{verbatim}{\em USES:}
\begin{verbatim} use modmain\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     lrstp  : radial step length (in,integer)
     lmax   : maximum angular momentum required (in,integer)
     is     : species number (in,integer)
     ia     : atom number (in,integer)
     ngp    : number of G+p-vectors (in,integer)
     apwalm : APW matching coefficients
              (in,complex(ngkmax,apwordmax,lmmaxapw,natmtot))
     evecfv : first-variational eigenvector (in,complex(nmatmax))
     ld     : leading dimension (in,integer)
     wfmt   : muffin-tin wavefunction (out,complex(ld,*))\end{verbatim}
{\sf DESCRIPTION:\\ }


  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created April 2003 (JKD)
     Fixed description, October 2004 (C. Brouder)
     Removed argument ist, November 2006 (JKD)\end{verbatim}

\markboth{Left}{Source File: writeangmom.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{writeangmom (Source File: writeangmom.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine writeangmom(un)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim} \end{verbatim}
{\sf DESCRIPTION:\\ }

    Outputs information about the angular momentum cutoffs to the file
     {\tt INFO\_XS.OUT}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: writeemat\_ascii.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writeemat.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writeeps.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writeexciton.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writegqpts.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{writegqpts (Source File: writegqpts.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim}   subroutine writegqpts(iq)\end{verbatim}{\em USES:}
\begin{verbatim}     use modmain
     use modxs
     use m_getunit\end{verbatim}
{\sf DESCRIPTION:\\ }


     Writes the ${\bf G+q}$-points in lattice coordinates, Cartesian 
     coordinates, and lengths of ${\bf G+q}$-vectors to the file 
     {\tt QPOINTS.OUT}. Based on the routine {\tt writekpts.f90}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: writekmapkq.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writeloss.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writepmat\_ascii.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writepmatxs.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{writepmatxs (Source File: writepmatxs.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine writepmatxs(lgather)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modmpi
   use modxs
   use m_putpmat
   use m_genfilname
   use m_genapwcmt\end{verbatim}
{\sf DESCRIPTION:\\ }


     Calculates the momentum matrix elements using routine {\tt genpmat} and
     writes them to direct access file {\tt PMAT\_XS.OUT}. Derived from
     the routine {\tt writepmat}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: writepwmat.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{writepwmat (Source File: writepwmat.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine writepwmat\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs
   use m_genfilname\end{verbatim}
{\sf DESCRIPTION:\\ }


     Calculates the matrix elements of the plane wave
     $e^{-i({\bf G}+{\bf q}){\bf r}}$
     using routine {\tt genpwmat} and writes them to
     direct access file {\tt PWMAT.OUT}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created November 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: writeqpts.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{writeqpts (Source File: writeqpts.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine writeqpts\end{verbatim}{\em USES:}
\begin{verbatim} use modmain
 use modxs
 use m_getunit
 use m_genfilname\end{verbatim}
{\sf DESCRIPTION:\\ }


     Writes the ${\bf q}$-points in lattice coordinates, weights and number of
     ${\bf G+q}$-vectors to the file {\tt QPOINTS.OUT}. Based on the routine 
     {\tt writekpts}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created October 2006 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: writesigma.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writesumrls.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: writesymi.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{writesymi (Source File: writesymi.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine writesymi\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain
   use modxs\end{verbatim}
{\sf DESCRIPTION:\\ }


     Outputs the crystal and symmetries including their inverse
     elements to file {\tt SYMINV.OUT}
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created December 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: x0toasc.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: x0tobin.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: xscheck.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: xsestimate.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: xsfinit.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: xsgeneigvec.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: xsinit.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: zaxpyc.F90,  Date: Wed May 14 11:56:01 CEST 2008
}


\markboth{Left}{Source File: zfinp2.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{zfinp2 (Source File: zfinp2.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} complex(8) function zfinp2(ngp1,ngp2,igpig,zfmt1,zfmt2,zfir1,zfir2)\end{verbatim}{\em USES:}
\begin{verbatim}   use modmain\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     zfmt1 : first complex function in spherical harmonics for all muffin-tins
             (in,complex(lmmaxvr,nrcmtmax,natmtot))
     zfmt2 : second complex function in spherical harmonics for all muffin-tins
             (in,complex(lmmaxvr,nrcmtmax,natmtot))
     zfir1 : first complex interstitial function in real-space
             (in,complex(ngrtot))
     zfir2 : second complex interstitial function in real-space
             (in,complex(ngrtot))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Calculates the inner product of two complex fuctions over the entire unit
     cell. The muffin-tin functions should be stored on the coarse radial grid
     and have angular momentum cut-off {\tt lmaxvr}. In the intersitial region,
     the integrand is multiplied with the smooth characteristic function,
     $\tilde{\Theta}({\bf r})$, to remove the contribution from the muffin-tin.
     See routines {\tt zfmtinp} and {\tt gencfun}.
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created July 2004 (Sharma)
     Modifications Jannuary 2007 (Sagmeister)\end{verbatim}

\markboth{Left}{Source File: zoutpr.F90,  Date: Wed May 14 11:56:01 CEST 2008
}

 
%/////////////////////////////////////////////////////////////
 
\mbox{}\hrulefill\ 
 
\subsection{zoutpr (Source File: zoutpr.F90)}


\bigskip{\sf INTERFACE:}
\begin{verbatim} subroutine zoutpr(n1,n2,alpha,x,y,a)\end{verbatim}{\em INPUT/OUTPUT PARAMETERS:}
\begin{verbatim}     n1,n2 : size of vectors and matrix, respectively (in,integer)
     alpha : complex constant (in,complex)
     x     : first input vector (in,complex(n1))
     y     : second input vector (in,complex(n2))
     a     : output matrix (out,complex(n1,n2))\end{verbatim}
{\sf DESCRIPTION:\\ }


     Performs the rank-2 operation
     $$ A_{ij}\rightarrow\alpha{\bf x}_i^*{\bf y}_j+A_{ij}. $$
  
\bigskip{\sf REVISION HISTORY:}
\begin{verbatim}     Created April 2008 (Sagmeister)\end{verbatim}

%...............................................................
\end{document}
